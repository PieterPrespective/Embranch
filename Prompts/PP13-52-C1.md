- IssueID = PP13-52
- Please read 'Prompts/BasePrompt.md' first for general context
- Please review and fix the current database of tests for this project
	- All tests are located in DMMSTesting, please ignore everythin in DMMSManualTesting for now
	- We'll start this review with tests that currently fail or lock - below a list with encountered issues in the testrunner; please deal with these in this order, since I first want to fix all tests that fail before focussing on tests that lock the testrunner
	- For all tests we review
		- Please investigate the topic dealt with by the test by querying the chroma issue database of this project 
			- if you deem a test is out-of-date feel free to just remove it
			- If a test is no longer up-to-date with the current implementation - please update the test; DO NOT CHANGE any production code in DMMS - if you're absolutely sure the production code is faulty; report that to me at the end of this assignment
- Test issues:
- ---
- â€‰DoltClone_EmptyRepositoryWithReadinessCheck_ShouldHandleNoDocuments
  â€‰Source:â€‰DoltCloneEmptyRepositoryTests.csâ€‰lineâ€‰483
  â€‰Duration:â€‰20.5 sec

  Message:â€‰
  Result should have 'documents_loaded' property
Assert.That(root.TryGetProperty("documents_loaded", out var docsElement), Is.True)
  Expected: True
  But was:  False


  Stack Trace:â€‰
DoltCloneEmptyRepositoryTests.DoltClone_EmptyRepositoryWithReadinessCheck_ShouldHandleNoDocuments()â€‰lineâ€‰572
GenericAdapter`1.BlockUntilCompleted()
NoMessagePumpStrategy.WaitForCompletion(AwaitAdapter awaiter)
AsyncToSyncAdapter.Await[TResult](TestExecutionContext context, Func`1 invoke)
AsyncToSyncAdapter.Await(TestExecutionContext context, Func`1 invoke)
TestMethodCommand.RunTestMethod(TestExecutionContext context)
TestMethodCommand.Execute(TestExecutionContext context)
DelegatingTestCommand.RunTestMethodInThreadAbortSafeZone(TestExecutionContext context, Action action)
1)    at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.DoltClone_EmptyRepositoryWithReadinessCheck_ShouldHandleNoDocuments() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 572
AsyncStateMachineBox`1.ExecutionContextCallback(Object s)

  Standard Output:â€‰
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Created test directories: Source=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\source_repo, Target=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\target_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\source_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\target_repo
info: DMMS.Services.ChromaPythonService[0]
      Created ChromaPythonService with client ID: ChromaPythonService_20251218_143522_155_cbb9c020
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ”§ ARRANGE: Creating repository with schema but no documents
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\empty_data_repo
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe init
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                CREATE TABLE documents (
                    doc_id VARCHAR(64) NOT NULL PRIMARY KEY,
                    collection_name VARCHAR(255) NOT NULL,
                    content TEXT NOT NULL,
                    content_hash CHAR(64) NOT NULL,
                    title VARCHAR(500),
                    doc_type VARCHAR(100),
                    metadata JSON,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
                )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                CREATE TABLE collections (
                    collection_name VARCHAR(255) NOT NULL PRIMARY KEY,
                    display_name VARCHAR(255),
                    description TEXT,
                    embedding_model VARCHAR(100) NOT NULL DEFAULT 'default',
                    chunk_size INT NOT NULL DEFAULT 512,
                    chunk_overlap INT NOT NULL DEFAULT 50,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
                    document_count INT DEFAULT 0,
                    metadata JSON
                )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Create schema with empty documents table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… Empty data repository created with schema but no documents
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸŽ¯ ACT: Attempting clone of repository with schema but no documents
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cloning from: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\empty_data_repo, branch=, commit=
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Formatted local path 'C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\empty_data_repo' to 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Performing pre-clone URL validation for: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Skipping pre-clone validation for non-DoltHub URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe clone file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo .
warn: DMMS.Services.DoltCli[0]
      Dolt command failed with exit code 1: clone failed; remote at that url contains no Dolt data

warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone operation failed: clone failed; remote at that url contains no Dolt data

info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone command attempted with URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Working directory: D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\bin\Release\net9.0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Empty repository error detected: True
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Full error message: 'clone failed; remote at that url contains no Dolt data
'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Empty repository detected, attempting fallback: init + remote setup
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: cleaning corrupted repository
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Found corrupted .dolt directory at 'C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\target_repo\.dolt' from failed clone, removing it
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Successfully removed corrupted .dolt directory
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: checking initialization status
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Repository initialization status after cleanup: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: initializing repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe init
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Init result - Success: True, Error: '', Output: 'Successfully initialized dolt data repository.
'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Repository initialized successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: validating remote URL with URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe remote add origin file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Add remote result - Success: True, Error: '', Output: ''
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Remote 'origin' configured successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: creating initial commit
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q CREATE TABLE IF NOT EXISTS __init_temp__ (id INT PRIMARY KEY, created_at DATETIME DEFAULT CURRENT_TIMESTAMP)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Created temporary initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Add result - Success: True, Error: ''
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Initial empty repository commit
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Initial commit result - Success: True, Hash: 'thh9s8skir99dml3m6s2n3mf4mlr8d1k', Message: 'Initial empty repository commit'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q DROP TABLE __init_temp__
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Dropped temporary initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Cleaned up initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cleanup commit result - Success: True, Hash: 'ft1a5mn7b5e9ov1or50ailvsk3psq4dm'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: setting up branch tracking
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT active_branch() as branch -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Current branch: main
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Fallback successful: Repository initialized with initial commits and remote 'origin' configured
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] Creating database schema for sync operations
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS collections (
    collection_name VARCHAR(255) PRIMARY KEY,
    display_name VARCHAR(255),
    description TEXT,
    embedding_model VARCHAR(100) DEFAULT 'default',
    chunk_size INT DEFAULT 512,
    chunk_overlap INT DEFAULT 50,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    document_count INT DEFAULT 0,
    metadata JSON,
    
    INDEX idx_created_at (created_at),
    INDEX idx_updated_at (updated_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created collections table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS documents (
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    content LONGTEXT NOT NULL,
    content_hash CHAR(64) NOT NULL,
    title VARCHAR(500),
    doc_type VARCHAR(100),
    metadata JSON NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_content_hash (content_hash),
    INDEX idx_title (title),
    INDEX idx_doc_type (doc_type),
    INDEX idx_created_at (created_at),
    INDEX idx_updated_at (updated_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created documents table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS chroma_sync_state (
    collection_name VARCHAR(255) PRIMARY KEY,
    last_sync_commit VARCHAR(40),
    last_sync_at DATETIME,
    document_count INT DEFAULT 0,
    chunk_count INT DEFAULT 0,
    embedding_model VARCHAR(100),
    sync_status ENUM('synced', 'pending', 'error', 'in_progress', 'local_changes') DEFAULT 'pending',
    local_changes_count INT DEFAULT 0,
    error_message TEXT,
    metadata JSON,
    
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_sync_status (sync_status),
    INDEX idx_last_sync_at (last_sync_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created chroma_sync_state table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS document_sync_log (
    id INT AUTO_INCREMENT PRIMARY KEY,
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    content_hash CHAR(64) NOT NULL,
    chroma_chunk_ids JSON,
    synced_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    sync_direction ENUM('dolt_to_chroma', 'chroma_to_dolt') NOT NULL,
    sync_action ENUM('added', 'modified', 'deleted', 'staged') NOT NULL,
    embedding_model VARCHAR(100),
    
    UNIQUE KEY uk_doc_collection (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_content_hash (content_hash),
    INDEX idx_synced_at (synced_at),
    INDEX idx_sync_direction (sync_direction)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created document_sync_log table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS local_changes (
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    change_type ENUM('new', 'modified', 'deleted') NOT NULL,
    detected_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    content_hash_chroma CHAR(64),
    content_hash_dolt CHAR(64),
    metadata JSON,
    
    PRIMARY KEY (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_change_type (change_type),
    INDEX idx_detected_at (detected_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created local_changes table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS sync_operations (
    operation_id INT AUTO_INCREMENT PRIMARY KEY,
    operation_type ENUM('init', 'commit', 'push', 'pull', 'merge', 'checkout', 'reset', 'stage') NOT NULL,
    dolt_branch VARCHAR(255) NOT NULL,
    dolt_commit_before VARCHAR(40),
    dolt_commit_after VARCHAR(40),
    chroma_collections_affected JSON,
    documents_added INT DEFAULT 0,
    documents_modified INT DEFAULT 0,
    documents_deleted INT DEFAULT 0,
    documents_staged INT DEFAULT 0,
    chunks_processed INT DEFAULT 0,
    operation_status ENUM('started', 'completed', 'failed', 'rolled_back', 'blocked') NOT NULL,
    blocked_reason VARCHAR(255),
    error_message TEXT,
    started_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME,
    metadata JSON,
    
    INDEX idx_operation_type (operation_type),
    INDEX idx_operation_status (operation_status),
    INDEX idx_started_at (started_at),
    INDEX idx_branch (dolt_branch)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created sync_operations table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Create database schema for sync operations
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Schema committed successfully: 1rui9909o3n5it1a79e51t32h2ban7u0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Database schema creation completed successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] Initializing sync state for newly created repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] Current commit hash: 1rui9909o3n5it1a79e51t32h2ban7u0
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT IGNORE INTO collections (
    collection_name,
    display_name,
    description,
    embedding_model,
    chunk_size,
    chunk_overlap,
    document_count,
    metadata
) VALUES (
    'default',
    'Default Collection',
    'Default collection created during repository initialization',
    'default',
    512,
    50,
    0,
    JSON_OBJECT('created_by', 'fallback_initialization')
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Created default collection entry
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT IGNORE INTO chroma_sync_state (
    collection_name,
    last_sync_commit,
    last_sync_at,
    document_count,
    chunk_count,
    embedding_model,
    sync_status,
    local_changes_count,
    metadata
) VALUES (
    'default',
    '1rui9909o3n5it1a79e51t32h2ban7u0',
    CURRENT_TIMESTAMP,
    0,
    0,
    'default',
    'synced',
    0,
    JSON_OBJECT('initialized_by', 'fallback_initialization', 'repository_type', 'empty_clone')
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Initialized sync state for default collection
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT INTO sync_operations (
    operation_type,
    dolt_branch,
    dolt_commit_after,
    chroma_collections_affected,
    documents_added,
    documents_modified,
    documents_deleted,
    chunks_processed,
    operation_status,
    metadata
) VALUES (
    'init',
    'main',
    '1rui9909o3n5it1a79e51t32h2ban7u0',
    '["default"]',
    0,
    0,
    0,
    0,
    'completed',
    JSON_OBJECT('operation', 'fallback_initialization', 'schema_created', true, 'timestamp', NOW())
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Recorded initialization operation in audit log
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Initialize sync state for empty repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Sync state initialization committed successfully: 2j60a0skd1pgubdp5n8sr7q63dpfji00
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Sync state initialization completed successfully
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe remote -v
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.ListRemotesAsync] Raw output: 'origin file://C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo 
'
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.ListRemotesAsync] Found 1 remotes: origin
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Verification: Found 1 remotes configured
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Remote: origin -> file://C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Repository has HEAD commit: 2j60a0skd1pgubdp5n8sr7q63dpfji00
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback completion status - Remote configured: True
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT active_branch() as branch -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe log --oneline -n 1
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Ensuring database readiness before sync operation
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] ðŸ” Starting database readiness verification after clone
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Attempt 1/8 - Testing database readiness
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 1: Basic connectivity
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SHOW TABLES -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Database responsive, found 6 tables
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'chroma_sync_state'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'collections'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'document_sync_log'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'documents'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'local_changes'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'sync_operations'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 2: Documents table accessibility
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 3: Documents table query test
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT COUNT(*) FROM documents -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Documents table queryable, contains 0 documents
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 4: Collection discovery query test
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DISTINCT collection_name FROM documents WHERE collection_name IS NOT NULL AND collection_name != '' -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Collection discovery query successful, found 0 collections
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ… Database readiness verified on attempt 1/8
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: About to call GetAvailableCollectionNamesAsync from SyncManagerV2
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: DeltaDetector instance type: DMMS.Services.DeltaDetectorV2
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT DISTINCT collection_name
                FROM documents
                WHERE collection_name IS NOT NULL AND collection_name != ''
                ORDER BY collection_name -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT DISTINCT collection_name
                FROM collections
                WHERE collection_name IS NOT NULL AND collection_name != ''
                ORDER BY collection_name -r json
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: GetAvailableCollectionNamesAsync returned 1 collections: [default]
info: DMMS.Services.SyncManagerV2[0]
      Found 1 collections in Dolt database, syncing all: default
info: DMMS.Services.SyncManagerV2[0]
      Performing full sync for collection default
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT 
                    doc_id,
                    collection_name,
                    content,
                    content_hash,
                    title,
                    doc_type,
                    CAST(metadata AS CHAR) as metadata_json
                FROM documents
                WHERE collection_name = 'default'
                ORDER BY doc_id -r json
info: DMMS.Services.ChromaPythonService[0]
      Checking ChromaDB compatibility for pre-existing database
info: DMMS.Services.ChromaPythonService[0]
      Starting ChromaDB compatibility check
info: DMMS.Services.ChromaPythonService[0]
      Validating ChromaDB client connection
Executing Python operation asynchronously: ValidateClientConnection
info: DMMS.Services.ChromaPythonService[0]
      ChromaDB connection successful - no migration needed
info: DMMS.Services.ChromaPythonService[0]
      Created PersistentClient for ChromaPythonService_20251218_143522_155_cbb9c020 at path: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\target_repo\chroma_data
info: DMMS.Services.ChromaPythonService[0]
      Created new ChromaDB client ChromaPythonService_20251218_143522_155_cbb9c020
info: DMMS.Services.ChromaPythonService[0]
      Initialized ChromaDB client ChromaPythonService_20251218_143522_155_cbb9c020 with config: persistent:C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143522\target_repo\chroma_data
info: DMMS.Services.ChromaPythonService[0]
      [ChromaPythonService.ListCollectionsAsync] Attempting to list # collections with limit Null, offset: Null
Executing Python operation asynchronously: ListCollections
info: DMMS.Services.SyncManagerV2[0]
      Collection default does not exist, skipping delete
info: DMMS.Services.SyncManagerV2[0]
      Creating collection default
info: DMMS.Services.ChromaPythonService[0]
      Attempting to create collection 'default'; python context is running: True
info: DMMS.Services.ChromaPythonService[0]
      Before PyObject
info: DMMS.Services.ChromaPythonService[0]
      Attempting to create collection within Python 'default'
info: DMMS.Services.ChromaPythonService[0]
      Created collection 'default'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                    INSERT IGNORE INTO collections (
                        collection_name,
                        display_name,
                        description,
                        embedding_model,
                        chunk_size,
                        chunk_overlap,
                        document_count,
                        metadata
                    ) VALUES (
                        'default',
                        'default',
                        'Collection auto-created during sync operation',
                        'default',
                        512,
                        50,
                        0,
                        JSON_OBJECT('created_by', 'auto_sync', 'created_at', NOW())
                    )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                INSERT INTO chroma_sync_state 
                    (collection_name, last_sync_commit, last_sync_at, document_count, chunk_count, sync_status)
                VALUES 
                    ('default', '2j60a0skd1pgubdp5n8sr7q63dpfji00', NOW(), 0, 0, 'synced')
                ON DUPLICATE KEY UPDATE
                    last_sync_commit = VALUES(last_sync_commit),
                    last_sync_at = VALUES(last_sync_at),
                    document_count = VALUES(document_count),
                    chunk_count = VALUES(chunk_count),
                    sync_status = VALUES(sync_status),
                    error_message = NULL
info: DMMS.Services.SyncManagerV2[0]
      Collection default sync completed: 0 documents, 0 chunks
info: DMMS.Services.SyncManagerV2[0]
      Full sync completed for all collections: 0 documents, 0 chunks
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DISTINCT collection_name FROM documents WHERE collection_name IS NOT NULL AND collection_name != '' -r json
info: DMMS.Tools.DoltCloneTool[0]
      Successfully synced 0 documents to ChromaDB in 1 collections
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… ASSERT: Validating empty documents handling with readiness check
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“„ Empty documents result: {
        "success": true,
        "repository": {
          "path": "./data/dolt-repo",
          "remote_url": "file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo"
        },
        "checkout": {
          "branch": "main",
          "commit": {
            "hash": "2j60a0skd1pgubdp5n8sr7q63dpfji00",
            "message": "[0m[33m([0m[36;1mHEAD -> [0m[33m[92mmain[0m) [0mInitialize sync state for empty repository",
            "timestamp": "2025-12-18T15:35:40.3826975+01:00"
          }
        },
        "sync_summary": {
          "sync_succeeded": true,
          "documents_loaded": 0,
          "collections_created": [
            "main"
          ],
          "sync_error": null
        },
        "message": "Repository was empty at 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143522/empty_data_repo'. Initialized local repository with initial commits and configured remote 'origin'. Repository is now ready for use."
      }
warn: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Could not fully clean up test environment
      System.IO.IOException: The process cannot access the file 'chroma.sqlite3' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.TearDown() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 107
info: DMMS.Services.ChromaPythonService[0]
      Disposing ChromaPythonService with client ID: ChromaPythonService_20251218_143522_155_cbb9c020
info: DMMS.Services.ChromaPythonService[0]
      Disposed ChromaDB client ChromaPythonService_20251218_143522_155_cbb9c020 (usage: 3)
info: DMMS.Services.ChromaPythonService[0]
      ChromaPythonService disposed successfully

---
â€‰DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion
  â€‰Source:â€‰DoltCloneEmptyRepositoryTests.csâ€‰lineâ€‰269
  â€‰Duration:â€‰1.3 sec

  Message:â€‰
  Should return early validation error, not generic clone failure
Assert.That(errorCode, Is.EqualTo("INVALID_REMOTE_URL"))
  Expected string length 18 but was 12. Strings differ at index 0.
  Expected: "INVALID_REMOTE_URL"
  But was:  "CLONE_FAILED"
  -----------^


  Stack Trace:â€‰
DoltCloneEmptyRepositoryTests.DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion()â€‰lineâ€‰307
GenericAdapter`1.BlockUntilCompleted()
NoMessagePumpStrategy.WaitForCompletion(AwaitAdapter awaiter)
AsyncToSyncAdapter.Await[TResult](TestExecutionContext context, Func`1 invoke)
AsyncToSyncAdapter.Await(TestExecutionContext context, Func`1 invoke)
TestMethodCommand.RunTestMethod(TestExecutionContext context)
TestMethodCommand.Execute(TestExecutionContext context)
DelegatingTestCommand.RunTestMethodInThreadAbortSafeZone(TestExecutionContext context, Action action)
1)    at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 307
AsyncStateMachineBox`1.ExecutionContextCallback(Object s)

  Standard Output:â€‰
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Created test directories: Source=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\source_repo, Target=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\source_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo
info: DMMS.Services.ChromaPythonService[0]
      Created ChromaPythonService with client ID: ChromaPythonService_20251218_143602_071_75175606
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ”§ ARRANGE: Testing early validation with invalid DoltHub URL
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“‹ Using invalid URL: https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸŽ¯ ACT: Attempting clone with invalid DoltHub URL
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cloning from: https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo, branch=, commit=
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Performing pre-clone URL validation for: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Pre-clone validation passed for URL: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Failed to clean up validation temp directory: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_8b6748a038c941878322a4d224ed63e8' because it is being used by another process.
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_8b6748a038c941878322a4d224ed63e8' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryInternal(String fullPath, Boolean topLevel, Boolean allowDirectoryNotEmpty)
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMS.Tools.DoltCloneTool.DoltClone(String remote_url, String branch, String commit) in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp\Tools\DoltCloneTool.cs:line 177
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe clone https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo .
warn: DMMS.Services.DoltCli[0]
      Dolt command failed with exit code 1: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied

warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone operation failed: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied

info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone command attempted with URL: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Working directory: D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\bin\Release\net9.0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Empty repository error detected: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Full error message: 'error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied
'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Final error handling - Empty repo error: False, Remote configured: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Returning non-empty repository error: CLONE_FAILED
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… ASSERT: Validating early URL validation and helpful error response
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“„ Invalid URL result: {
        "success": false,
        "error": "CLONE_FAILED",
        "message": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied\n",
        "attempted_url": "https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo",
        "clone_error": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied\n"
      }
warn: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Could not fully clean up test environment
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.TearDown() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 107
info: DMMS.Services.ChromaPythonService[0]
      Disposing ChromaPythonService with client ID: ChromaPythonService_20251218_143602_071_75175606
info: DMMS.Services.ChromaPythonService[0]
      ChromaPythonService disposed successfully

---
â€‰â€‰DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion
  â€‰Source:â€‰DoltCloneEmptyRepositoryTests.csâ€‰lineâ€‰269
  â€‰Duration:â€‰1.3 sec

  Message:â€‰
  Should return early validation error, not generic clone failure
Assert.That(errorCode, Is.EqualTo("INVALID_REMOTE_URL"))
  Expected string length 18 but was 12. Strings differ at index 0.
  Expected: "INVALID_REMOTE_URL"
  But was:  "CLONE_FAILED"
  -----------^


  Stack Trace:â€‰
DoltCloneEmptyRepositoryTests.DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion()â€‰lineâ€‰307
GenericAdapter`1.BlockUntilCompleted()
NoMessagePumpStrategy.WaitForCompletion(AwaitAdapter awaiter)
AsyncToSyncAdapter.Await[TResult](TestExecutionContext context, Func`1 invoke)
AsyncToSyncAdapter.Await(TestExecutionContext context, Func`1 invoke)
TestMethodCommand.RunTestMethod(TestExecutionContext context)
TestMethodCommand.Execute(TestExecutionContext context)
DelegatingTestCommand.RunTestMethodInThreadAbortSafeZone(TestExecutionContext context, Action action)
1)    at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.DoltClone_InvalidRemoteUrl_ShouldFailEarlyWithSuggestion() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 307
AsyncStateMachineBox`1.ExecutionContextCallback(Object s)

  Standard Output:â€‰
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Created test directories: Source=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\source_repo, Target=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\source_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo
info: DMMS.Services.ChromaPythonService[0]
      Created ChromaPythonService with client ID: ChromaPythonService_20251218_143602_071_75175606
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ”§ ARRANGE: Testing early validation with invalid DoltHub URL
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“‹ Using invalid URL: https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸŽ¯ ACT: Attempting clone with invalid DoltHub URL
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cloning from: https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo, branch=, commit=
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Performing pre-clone URL validation for: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Pre-clone validation passed for URL: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Failed to clean up validation temp directory: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_8b6748a038c941878322a4d224ed63e8' because it is being used by another process.
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_8b6748a038c941878322a4d224ed63e8' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryInternal(String fullPath, Boolean topLevel, Boolean allowDirectoryNotEmpty)
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMS.Tools.DoltCloneTool.DoltClone(String remote_url, String branch, String commit) in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp\Tools\DoltCloneTool.cs:line 177
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe clone https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo .
warn: DMMS.Services.DoltCli[0]
      Dolt command failed with exit code 1: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied

warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone operation failed: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied

info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone command attempted with URL: 'https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Working directory: D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\bin\Release\net9.0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Empty repository error detected: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Full error message: 'error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied
'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Final error handling - Empty repo error: False, Remote configured: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Returning non-empty repository error: CLONE_FAILED
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… ASSERT: Validating early URL validation and helpful error response
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“„ Invalid URL result: {
        "success": false,
        "error": "CLONE_FAILED",
        "message": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied\n",
        "attempted_url": "https://www.dolthub.com/repositories/nonexistent-user/nonexistent-repo",
        "clone_error": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/nonexistent-user/nonexistent-repo': rpc error: code = PermissionDenied desc = permission denied\n"
      }
warn: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Could not fully clean up test environment
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143602\target_repo' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.TearDown() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 107
info: DMMS.Services.ChromaPythonService[0]
      Disposing ChromaPythonService with client ID: ChromaPythonService_20251218_143602_071_75175606
info: DMMS.Services.ChromaPythonService[0]
      ChromaPythonService disposed successfully

---
â€‰DoltClone_RemoteWithNoDataButValidStructure_ShouldVerifyReadiness
  â€‰Source:â€‰DoltCloneEmptyRepositoryTests.csâ€‰lineâ€‰600
  â€‰Duration:â€‰20.8 sec

  Message:â€‰
  Result should have 'documents_loaded' property
Assert.That(root.TryGetProperty("documents_loaded", out var docsElement), Is.True)
  Expected: True
  But was:  False


  Stack Trace:â€‰
DoltCloneEmptyRepositoryTests.DoltClone_RemoteWithNoDataButValidStructure_ShouldVerifyReadiness()â€‰lineâ€‰711
GenericAdapter`1.BlockUntilCompleted()
NoMessagePumpStrategy.WaitForCompletion(AwaitAdapter awaiter)
AsyncToSyncAdapter.Await[TResult](TestExecutionContext context, Func`1 invoke)
AsyncToSyncAdapter.Await(TestExecutionContext context, Func`1 invoke)
TestMethodCommand.RunTestMethod(TestExecutionContext context)
TestMethodCommand.Execute(TestExecutionContext context)
DelegatingTestCommand.RunTestMethodInThreadAbortSafeZone(TestExecutionContext context, Action action)
1)    at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.DoltClone_RemoteWithNoDataButValidStructure_ShouldVerifyReadiness() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 711
AsyncStateMachineBox`1.ExecutionContextCallback(Object s)

  Standard Output:â€‰
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Created test directories: Source=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\source_repo, Target=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\target_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\source_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\target_repo
info: DMMS.Services.ChromaPythonService[0]
      Created ChromaPythonService with client ID: ChromaPythonService_20251218_143603_340_84f128ba
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ”§ ARRANGE: Creating remote with complete schema but no document data
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\no_data_remote
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe init
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                CREATE TABLE documents (
                    doc_id VARCHAR(64) NOT NULL PRIMARY KEY,
                    collection_name VARCHAR(255) NOT NULL,
                    content TEXT NOT NULL,
                    content_hash CHAR(64) NOT NULL,
                    title VARCHAR(500),
                    doc_type VARCHAR(100),
                    metadata JSON,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
                    INDEX idx_collection (collection_name),
                    INDEX idx_hash (content_hash),
                    INDEX idx_created (created_at)
                )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                CREATE TABLE collections (
                    collection_name VARCHAR(255) NOT NULL PRIMARY KEY,
                    display_name VARCHAR(255),
                    description TEXT,
                    embedding_model VARCHAR(100) NOT NULL DEFAULT 'default',
                    chunk_size INT NOT NULL DEFAULT 512,
                    chunk_overlap INT NOT NULL DEFAULT 50,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
                    document_count INT DEFAULT 0,
                    metadata JSON
                )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                CREATE TABLE chroma_sync_state (
                    collection_name VARCHAR(255) NOT NULL PRIMARY KEY,
                    last_sync_commit VARCHAR(40),
                    last_sync_at DATETIME,
                    document_count INT DEFAULT 0,
                    chunk_count INT DEFAULT 0,
                    embedding_model VARCHAR(100),
                    sync_status ENUM('pending', 'syncing', 'synced', 'error') DEFAULT 'pending',
                    local_changes_count INT DEFAULT 0,
                    error_message TEXT,
                    metadata JSON
                )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                INSERT INTO collections (collection_name, display_name, description, document_count) 
                VALUES ('main', 'Main Collection', 'Main collection with no documents', 0)
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Create complete schema with empty collections
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… No-data remote repository created with complete schema and empty collections
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸŽ¯ ACT: Attempting clone of remote with valid structure but no document data
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cloning from: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\no_data_remote, branch=, commit=
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Formatted local path 'C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\no_data_remote' to 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Performing pre-clone URL validation for: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Skipping pre-clone validation for non-DoltHub URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe clone file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote .
warn: DMMS.Services.DoltCli[0]
      Dolt command failed with exit code 1: clone failed; remote at that url contains no Dolt data

warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone operation failed: clone failed; remote at that url contains no Dolt data

info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone command attempted with URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Working directory: D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\bin\Release\net9.0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Empty repository error detected: True
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Full error message: 'clone failed; remote at that url contains no Dolt data
'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Empty repository detected, attempting fallback: init + remote setup
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: cleaning corrupted repository
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Found corrupted .dolt directory at 'C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\target_repo\.dolt' from failed clone, removing it
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Successfully removed corrupted .dolt directory
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: checking initialization status
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Repository initialization status after cleanup: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: initializing repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe init
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Init result - Success: True, Error: '', Output: 'Successfully initialized dolt data repository.
'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Repository initialized successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: validating remote URL with URL: 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe remote add origin file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Add remote result - Success: True, Error: '', Output: ''
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Remote 'origin' configured successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: creating initial commit
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q CREATE TABLE IF NOT EXISTS __init_temp__ (id INT PRIMARY KEY, created_at DATETIME DEFAULT CURRENT_TIMESTAMP)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Created temporary initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Add result - Success: True, Error: ''
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Initial empty repository commit
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Initial commit result - Success: True, Hash: '0ojid27hmn285abtc22rkuj5trhrqcnt', Message: 'Initial empty repository commit'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q DROP TABLE __init_temp__
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Dropped temporary initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Cleaned up initialization table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cleanup commit result - Success: True, Hash: '1gbcrr0t07tvnke105hv4tvs0ma0jr0f'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback step: setting up branch tracking
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT active_branch() as branch -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Current branch: main
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Fallback successful: Repository initialized with initial commits and remote 'origin' configured
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] Creating database schema for sync operations
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS collections (
    collection_name VARCHAR(255) PRIMARY KEY,
    display_name VARCHAR(255),
    description TEXT,
    embedding_model VARCHAR(100) DEFAULT 'default',
    chunk_size INT DEFAULT 512,
    chunk_overlap INT DEFAULT 50,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    document_count INT DEFAULT 0,
    metadata JSON,
    
    INDEX idx_created_at (created_at),
    INDEX idx_updated_at (updated_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created collections table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS documents (
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    content LONGTEXT NOT NULL,
    content_hash CHAR(64) NOT NULL,
    title VARCHAR(500),
    doc_type VARCHAR(100),
    metadata JSON NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_content_hash (content_hash),
    INDEX idx_title (title),
    INDEX idx_doc_type (doc_type),
    INDEX idx_created_at (created_at),
    INDEX idx_updated_at (updated_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created documents table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS chroma_sync_state (
    collection_name VARCHAR(255) PRIMARY KEY,
    last_sync_commit VARCHAR(40),
    last_sync_at DATETIME,
    document_count INT DEFAULT 0,
    chunk_count INT DEFAULT 0,
    embedding_model VARCHAR(100),
    sync_status ENUM('synced', 'pending', 'error', 'in_progress', 'local_changes') DEFAULT 'pending',
    local_changes_count INT DEFAULT 0,
    error_message TEXT,
    metadata JSON,
    
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_sync_status (sync_status),
    INDEX idx_last_sync_at (last_sync_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created chroma_sync_state table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS document_sync_log (
    id INT AUTO_INCREMENT PRIMARY KEY,
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    content_hash CHAR(64) NOT NULL,
    chroma_chunk_ids JSON,
    synced_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    sync_direction ENUM('dolt_to_chroma', 'chroma_to_dolt') NOT NULL,
    sync_action ENUM('added', 'modified', 'deleted', 'staged') NOT NULL,
    embedding_model VARCHAR(100),
    
    UNIQUE KEY uk_doc_collection (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_content_hash (content_hash),
    INDEX idx_synced_at (synced_at),
    INDEX idx_sync_direction (sync_direction)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created document_sync_log table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS local_changes (
    doc_id VARCHAR(64) NOT NULL,
    collection_name VARCHAR(255) NOT NULL,
    change_type ENUM('new', 'modified', 'deleted') NOT NULL,
    detected_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    content_hash_chroma CHAR(64),
    content_hash_dolt CHAR(64),
    metadata JSON,
    
    PRIMARY KEY (doc_id, collection_name),
    FOREIGN KEY (collection_name) REFERENCES collections(collection_name) ON DELETE CASCADE,
    INDEX idx_change_type (change_type),
    INDEX idx_detected_at (detected_at)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created local_changes table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
CREATE TABLE IF NOT EXISTS sync_operations (
    operation_id INT AUTO_INCREMENT PRIMARY KEY,
    operation_type ENUM('init', 'commit', 'push', 'pull', 'merge', 'checkout', 'reset', 'stage') NOT NULL,
    dolt_branch VARCHAR(255) NOT NULL,
    dolt_commit_before VARCHAR(40),
    dolt_commit_after VARCHAR(40),
    chroma_collections_affected JSON,
    documents_added INT DEFAULT 0,
    documents_modified INT DEFAULT 0,
    documents_deleted INT DEFAULT 0,
    documents_staged INT DEFAULT 0,
    chunks_processed INT DEFAULT 0,
    operation_status ENUM('started', 'completed', 'failed', 'rolled_back', 'blocked') NOT NULL,
    blocked_reason VARCHAR(255),
    error_message TEXT,
    started_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME,
    metadata JSON,
    
    INDEX idx_operation_type (operation_type),
    INDEX idx_operation_status (operation_status),
    INDEX idx_started_at (started_at),
    INDEX idx_branch (dolt_branch)
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Created sync_operations table
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Create database schema for sync operations
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Schema committed successfully: 7h36lvknnumva6kl0qao8t1eo71lpnmo
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.CreateSyncDatabaseSchemaAsync] âœ“ Database schema creation completed successfully
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] Initializing sync state for newly created repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] Current commit hash: 7h36lvknnumva6kl0qao8t1eo71lpnmo
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT IGNORE INTO collections (
    collection_name,
    display_name,
    description,
    embedding_model,
    chunk_size,
    chunk_overlap,
    document_count,
    metadata
) VALUES (
    'default',
    'Default Collection',
    'Default collection created during repository initialization',
    'default',
    512,
    50,
    0,
    JSON_OBJECT('created_by', 'fallback_initialization')
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Created default collection entry
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT IGNORE INTO chroma_sync_state (
    collection_name,
    last_sync_commit,
    last_sync_at,
    document_count,
    chunk_count,
    embedding_model,
    sync_status,
    local_changes_count,
    metadata
) VALUES (
    'default',
    '7h36lvknnumva6kl0qao8t1eo71lpnmo',
    CURRENT_TIMESTAMP,
    0,
    0,
    'default',
    'synced',
    0,
    JSON_OBJECT('initialized_by', 'fallback_initialization', 'repository_type', 'empty_clone')
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Initialized sync state for default collection
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
INSERT INTO sync_operations (
    operation_type,
    dolt_branch,
    dolt_commit_after,
    chroma_collections_affected,
    documents_added,
    documents_modified,
    documents_deleted,
    chunks_processed,
    operation_status,
    metadata
) VALUES (
    'init',
    'main',
    '7h36lvknnumva6kl0qao8t1eo71lpnmo',
    '["default"]',
    0,
    0,
    0,
    0,
    'completed',
    JSON_OBJECT('operation', 'fallback_initialization', 'schema_created', true, 'timestamp', NOW())
)
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Recorded initialization operation in audit log
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe add -A
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe commit -m Initialize sync state for empty repository
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Sync state initialization committed successfully: avsa0brmbl8d8phbqigte0akhkk5fkb8
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.InitializeSyncStateAsync] âœ“ Sync state initialization completed successfully
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe remote -v
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.ListRemotesAsync] Raw output: 'origin file://C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote 
'
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.ListRemotesAsync] Found 1 remotes: origin
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Verification: Found 1 remotes configured
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Remote: origin -> file://C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Repository has HEAD commit: avsa0brmbl8d8phbqigte0akhkk5fkb8
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Fallback completion status - Remote configured: True
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT active_branch() as branch -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe log --oneline -n 1
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Ensuring database readiness before sync operation
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] ðŸ” Starting database readiness verification after clone
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Attempt 1/8 - Testing database readiness
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 1: Basic connectivity
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SHOW TABLES -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Database responsive, found 6 tables
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'chroma_sync_state'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'collections'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'document_sync_log'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'documents'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'local_changes'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Found table: 'sync_operations'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Table object type: System.Text.Json.JsonElement
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'ValueKind' = 'Object'
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] DIAGNOSTICS - Property 'Item' failed: Parameter count mismatch.
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 2: Documents table accessibility
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 3: Documents table query test
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT COUNT(*) FROM documents -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Documents table queryable, contains 0 documents
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] Test 4: Collection discovery query test
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DISTINCT collection_name FROM documents WHERE collection_name IS NOT NULL AND collection_name != '' -r json
dbug: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ“ Collection discovery query successful, found 0 collections
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.EnsureDatabaseReadyAsync] âœ… Database readiness verified on attempt 1/8
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: About to call GetAvailableCollectionNamesAsync from SyncManagerV2
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: DeltaDetector instance type: DMMS.Services.DeltaDetectorV2
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT DISTINCT collection_name
                FROM documents
                WHERE collection_name IS NOT NULL AND collection_name != ''
                ORDER BY collection_name -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT DISTINCT collection_name
                FROM collections
                WHERE collection_name IS NOT NULL AND collection_name != ''
                ORDER BY collection_name -r json
info: DMMS.Services.SyncManagerV2[0]
      PP13-49: GetAvailableCollectionNamesAsync returned 1 collections: [default]
info: DMMS.Services.SyncManagerV2[0]
      Found 1 collections in Dolt database, syncing all: default
info: DMMS.Services.SyncManagerV2[0]
      Performing full sync for collection default
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                SELECT 
                    doc_id,
                    collection_name,
                    content,
                    content_hash,
                    title,
                    doc_type,
                    CAST(metadata AS CHAR) as metadata_json
                FROM documents
                WHERE collection_name = 'default'
                ORDER BY doc_id -r json
info: DMMS.Services.ChromaPythonService[0]
      Checking ChromaDB compatibility for pre-existing database
info: DMMS.Services.ChromaPythonService[0]
      Starting ChromaDB compatibility check
info: DMMS.Services.ChromaPythonService[0]
      Validating ChromaDB client connection
Executing Python operation asynchronously: ValidateClientConnection
info: DMMS.Services.ChromaPythonService[0]
      ChromaDB connection successful - no migration needed
info: DMMS.Services.ChromaPythonService[0]
      Created PersistentClient for ChromaPythonService_20251218_143603_340_84f128ba at path: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\target_repo\chroma_data
info: DMMS.Services.ChromaPythonService[0]
      Created new ChromaDB client ChromaPythonService_20251218_143603_340_84f128ba
info: DMMS.Services.ChromaPythonService[0]
      Initialized ChromaDB client ChromaPythonService_20251218_143603_340_84f128ba with config: persistent:C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143603\target_repo\chroma_data
info: DMMS.Services.ChromaPythonService[0]
      [ChromaPythonService.ListCollectionsAsync] Attempting to list # collections with limit Null, offset: Null
Executing Python operation asynchronously: ListCollections
info: DMMS.Services.SyncManagerV2[0]
      Collection default does not exist, skipping delete
info: DMMS.Services.SyncManagerV2[0]
      Creating collection default
info: DMMS.Services.ChromaPythonService[0]
      Attempting to create collection 'default'; python context is running: True
info: DMMS.Services.ChromaPythonService[0]
      Before PyObject
info: DMMS.Services.ChromaPythonService[0]
      Attempting to create collection within Python 'default'
info: DMMS.Services.ChromaPythonService[0]
      Created collection 'default'
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DOLT_HASHOF('HEAD') as hash -r json
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                    INSERT IGNORE INTO collections (
                        collection_name,
                        display_name,
                        description,
                        embedding_model,
                        chunk_size,
                        chunk_overlap,
                        document_count,
                        metadata
                    ) VALUES (
                        'default',
                        'default',
                        'Collection auto-created during sync operation',
                        'default',
                        512,
                        50,
                        0,
                        JSON_OBJECT('created_by', 'auto_sync', 'created_at', NOW())
                    )
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q 
                INSERT INTO chroma_sync_state 
                    (collection_name, last_sync_commit, last_sync_at, document_count, chunk_count, sync_status)
                VALUES 
                    ('default', 'avsa0brmbl8d8phbqigte0akhkk5fkb8', NOW(), 0, 0, 'synced')
                ON DUPLICATE KEY UPDATE
                    last_sync_commit = VALUES(last_sync_commit),
                    last_sync_at = VALUES(last_sync_at),
                    document_count = VALUES(document_count),
                    chunk_count = VALUES(chunk_count),
                    sync_status = VALUES(sync_status),
                    error_message = NULL
info: DMMS.Services.SyncManagerV2[0]
      Collection default sync completed: 0 documents, 0 chunks
info: DMMS.Services.SyncManagerV2[0]
      Full sync completed for all collections: 0 documents, 0 chunks
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe sql -q SELECT DISTINCT collection_name FROM documents WHERE collection_name IS NOT NULL AND collection_name != '' -r json
info: DMMS.Tools.DoltCloneTool[0]
      Successfully synced 0 documents to ChromaDB in 1 collections
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… ASSERT: Validating structured empty repository handling
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“„ No-data remote result: {
        "success": true,
        "repository": {
          "path": "./data/dolt-repo",
          "remote_url": "file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote"
        },
        "checkout": {
          "branch": "main",
          "commit": {
            "hash": "avsa0brmbl8d8phbqigte0akhkk5fkb8",
            "message": "[0m[33m([0m[36;1mHEAD -> [0m[33m[92mmain[0m) [0mInitialize sync state for empty repository",
            "timestamp": "2025-12-18T15:36:21.9311240+01:00"
          }
        },
        "sync_summary": {
          "sync_succeeded": true,
          "documents_loaded": 0,
          "collections_created": [
            "main"
          ],
          "sync_error": null
        },
        "message": "Repository was empty at 'file:///C:/Users/piete/AppData/Local/Temp/DoltCloneEmptyRepoTest_20251218_143603/no_data_remote'. Initialized local repository with initial commits and configured remote 'origin'. Repository is now ready for use."
      }
warn: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Could not fully clean up test environment
      System.IO.IOException: The process cannot access the file 'chroma.sqlite3' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.TearDown() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 107
info: DMMS.Services.ChromaPythonService[0]
      Disposing ChromaPythonService with client ID: ChromaPythonService_20251218_143603_340_84f128ba
info: DMMS.Services.ChromaPythonService[0]
      Disposed ChromaDB client ChromaPythonService_20251218_143603_340_84f128ba (usage: 3)
info: DMMS.Services.ChromaPythonService[0]
      ChromaPythonService disposed successfully

---
â€‰DoltClone_UsernameRepoFormat_ShouldConvertCorrectly
  â€‰Source:â€‰DoltCloneEmptyRepositoryTests.csâ€‰lineâ€‰336
  â€‰Duration:â€‰1.3 sec

  Message:â€‰
  Should fail due to remote validation, not format issues
Assert.That(errorCode, Is.EqualTo("INVALID_REMOTE_URL").Or.EqualTo("REMOTE_NOT_FOUND"))
  Expected: "INVALID_REMOTE_URL" or "REMOTE_NOT_FOUND"
  But was:  "CLONE_FAILED"


  Stack Trace:â€‰
DoltCloneEmptyRepositoryTests.DoltClone_UsernameRepoFormat_ShouldConvertCorrectly()â€‰lineâ€‰380
GenericAdapter`1.BlockUntilCompleted()
NoMessagePumpStrategy.WaitForCompletion(AwaitAdapter awaiter)
AsyncToSyncAdapter.Await[TResult](TestExecutionContext context, Func`1 invoke)
AsyncToSyncAdapter.Await(TestExecutionContext context, Func`1 invoke)
TestMethodCommand.RunTestMethod(TestExecutionContext context)
TestMethodCommand.Execute(TestExecutionContext context)
DelegatingTestCommand.RunTestMethodInThreadAbortSafeZone(TestExecutionContext context, Action action)
1)    at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.DoltClone_UsernameRepoFormat_ShouldConvertCorrectly() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 380
AsyncStateMachineBox`1.ExecutionContextCallback(Object s)

  Standard Output:â€‰
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Created test directories: Source=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143624\source_repo, Target=C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143624\target_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143624\source_repo
dbug: DMMS.Services.DoltCli[0]
      [DoltCli] DoltCLI Initialized, setting up repository directory..
dbug: DMMS.Services.DoltCli[0]
      [DoltCli.EnsureRepositoryDirectoryExists] Repository directory already exists: C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143624\target_repo
info: DMMS.Services.ChromaPythonService[0]
      Created ChromaPythonService with client ID: ChromaPythonService_20251218_143624_161_b7ac451a
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ”§ ARRANGE: Testing username/database format conversion
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“‹ Using shorthand format: test-user/test-database
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸŽ¯ ACT: Attempting clone with shorthand username/database format
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Cloning from: test-user/test-database, branch=, commit=
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Formatted DoltHub repo 'test-user/test-database' to 'https://doltremoteapi.dolthub.com/test-user/test-database'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Performing pre-clone URL validation for: 'https://doltremoteapi.dolthub.com/test-user/test-database'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] âœ“ Pre-clone validation passed for URL: 'https://doltremoteapi.dolthub.com/test-user/test-database'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Failed to clean up validation temp directory: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_ac906ec235404822b935c9bce74ac705' because it is being used by another process.
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\dolt_url_test_ac906ec235404822b935c9bce74ac705' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryInternal(String fullPath, Boolean topLevel, Boolean allowDirectoryNotEmpty)
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMS.Tools.DoltCloneTool.DoltClone(String remote_url, String branch, String commit) in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp\Tools\DoltCloneTool.cs:line 177
dbug: DMMS.Services.DoltCli[0]
      Executing: C:\Program Files\Dolt\bin\dolt.exe clone https://doltremoteapi.dolthub.com/test-user/test-database .
warn: DMMS.Services.DoltCli[0]
      Dolt command failed with exit code 1: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/test-user/test-database': rpc error: code = PermissionDenied desc = permission denied

warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone operation failed: error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/test-user/test-database': rpc error: code = PermissionDenied desc = permission denied

info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Clone command attempted with URL: 'https://doltremoteapi.dolthub.com/test-user/test-database'
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Working directory: D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\bin\Release\net9.0
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Empty repository error detected: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Full error message: 'error: failed to get remote db
cause: could not access dolt url 'https://doltremoteapi.dolthub.com/test-user/test-database': rpc error: code = PermissionDenied desc = permission denied
'
warn: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Final error handling - Empty repo error: False, Remote configured: False
info: DMMS.Tools.DoltCloneTool[0]
      [DoltCloneTool.DoltClone] Returning non-empty repository error: CLONE_FAILED
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      âœ… ASSERT: Validating URL format conversion
info: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      ðŸ“„ Shorthand format result: {
        "success": false,
        "error": "CLONE_FAILED",
        "message": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/test-user/test-database': rpc error: code = PermissionDenied desc = permission denied\n",
        "attempted_url": "https://doltremoteapi.dolthub.com/test-user/test-database",
        "clone_error": "error: failed to get remote db\ncause: could not access dolt url 'https://doltremoteapi.dolthub.com/test-user/test-database': rpc error: code = PermissionDenied desc = permission denied\n"
      }
warn: DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests[0]
      Could not fully clean up test environment
      System.IO.IOException: The process cannot access the file '\\?\C:\Users\piete\AppData\Local\Temp\DoltCloneEmptyRepoTest_20251218_143624\target_repo' because it is being used by another process.
         at System.IO.FileSystem.RemoveDirectoryRecursive(String fullPath, WIN32_FIND_DATA& findData, Boolean topLevel)
         at System.IO.FileSystem.RemoveDirectory(String fullPath, Boolean recursive)
         at DMMSTesting.IntegrationTests.DoltCloneEmptyRepositoryTests.TearDown() in D:\Prespective\GIT\git-multidolt-mcp\git-multidolt-mcp\multidolt-mcp-testing\IntegrationTests\DoltCloneEmptyRepositoryTests.cs:line 107
info: DMMS.Services.ChromaPythonService[0]
      Disposing ChromaPythonService with client ID: ChromaPythonService_20251218_143624_161_b7ac451a
info: DMMS.Services.ChromaPythonService[0]
      ChromaPythonService disposed successfully
